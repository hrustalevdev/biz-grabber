# biz-grabber

## Описание

Утилита пробегается по колонке `ИНН`, предоставленного `.xlsx` файла, и по каждому ИНН обращается в сервис  `dadata` за сведениями об организации. На данный момент - это сведения о статусе организации - `активна`, `ликвидирована` и т.п. Полученные данные сохраняются в отдельный `.xlsx` файл.

## Установка

Только для разработки.

```shell
npm i
```

## Использование

1. Разместите исходный `.xlsx` файл в папке `input`.
   * Файл **строго** должен содержать в 4-й колонке (`D`) ИНН организаций.
2. Находясь в папке с программой запустить скрипт:

```shell
npm run grab
```

По умолчанию данный скрипт делает одновременно 100 запросов к сервису. При возникновении ошибок, связанных с количеством единовременных обращений к серверу, можно попробовать запустить скрипт понизив количество одновременных запросов. За это отвечает переменная `GRAB_SIZE`:

```shell
GRAB_SIZE=50 npm run grab
```

Диапазон значений переменной `GRAB_SIZE` от 1 до 1000. Значения вне данного диапазона не будут восприняты и скрипт запуститься со значением по умолчанию. 
