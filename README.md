# biz-grabber

## Описание

Утилита пробегается по колонке `ИНН`, предоставленного `.xlsx` файла, и по каждому ИНН обращается в сервис  `dadata` за сведениями об организации. На данный момент - это сведения о статусе организации - `активна`, `ликвидирована` и т.п. Полученные данные сохраняются в отдельный `.xlsx` файл.

## Установка

Только для разработки.

```shell
npm i
```

## Использование

1. Добавьте папку `input` на одном уровне (т.е. рядом) с папкой `dist`.
2. Разместите исходный `.xlsx` файл в папке `input`.
   * Файл **строго** должен содержать в 4-й колонке (`D`) ИНН организаций.
3. Находясь в папке с программой запустить скрипт:

   ```shell
   npm run grab
   ```
   
   По умолчанию данный скрипт делает одновременно 100 запросов к сервису. При возникновении ошибок, связанных с количеством единовременных обращений к серверу, можно попробовать запустить скрипт понизив количество одновременных запросов. За это отвечает переменная `GRAB_SIZE`, т.е. запустить скрипт таким образом:
   
   ```shell
   GRAB_SIZE=50 npm run grab
   ```
   
   Диапазон значений переменной `GRAB_SIZE` от 1 до 1000. Значения вне данного диапазона не будут восприняты и скрипт запуститься со значением по умолчанию.
4. После выполнения скрипта, рядом с папкой `dist` появится папка `output`, в данной папке будет находиться `.xlsx` файл с результатом.
